\usepackage[top=25mm, bottom=22mm, left=20mm, right=20mm]{geometry}
\usepackage{graphicx}
\usepackage{parskip}
\usepackage{titlesec}
\usepackage[hidelinks]{hyperref}
\usepackage{enumitem}
\usepackage{fancyhdr}
\usepackage{quoting}
\usepackage[hang, perpage]{footmisc}
\usepackage{xcolor}
\usepackage{needspace}

\graphicspath{ {./image/} }

\setlength{\parskip}{1em}
\setlength{\parindent}{0mm}
\setlength{\footnotesep}{1em}
\setlength{\footnotemargin}{3ex}

\linespread{1.5}
% \setlist{nosep}

\ziju{0.05}
\ctexset{
    chapter/numbering = false,
    section/numbering = false,
    subsection/numbering = false,
    chapter/format += \Large,
    section/format += \large,%\raggedright,
    subsection/format += \normalsize,
    tocdepth = section,
    contentsname = 目次,
}

\setcounter{secnumdepth}{0} % remove section numbering
\titlespacing*{\section}{0pt}{5mm plus 2mm minus 1mm}{4mm plus 2mm minus 1mm} % spacing around section
% \titlespacing*{\subsection}{0pt}{3mm plus 1mm minus 1mm}{3mm plus 1mm minus 1mm}
\titlespacing*{\subsection}{0pt}{0mm plus 2mm minus 2mm}{0mm plus 2mm minus 2mm}

\fancyhf{}
% \fancyhead[LE,RO]{\small \thepage} % page number on even (L) and odd (R) pages
% \fancyhead[RE]{\small \leftmark} % chapter title on even pages
% \fancyhead[LO]{\small \rightmark} % section title on odd pages
\fancyhead[RO]{\footnotesize \rightmark \hspace{5mm} \thepage}
\fancyhead[LE]{\footnotesize \thepage \hspace{5mm} \leftmark}
\pagestyle{fancy}
\renewcommand{\headrulewidth}{0pt}
\fancypagestyle{plain}{% define first page of a chapter
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
    % \fancyfoot[C]{\footnotesize \thepage}
}
\fancypagestyle{empty}{% define empty page, e.g. back of cover
    \fancyhf{}
    \renewcommand{\headrulewidth}{0pt}
    \renewcommand{\footrulewidth}{0pt}
}

\quotingsetup{
    leftmargin=2em,
    rightmargin=0em,
    % font=footnotesize,
}

\let\oldsubsection\subsection
\renewcommand{\subsection}[1]{
    \needspace{2\baselineskip} % 确保有至少 2 行的空间
    \oldsubsection{#1}%
}